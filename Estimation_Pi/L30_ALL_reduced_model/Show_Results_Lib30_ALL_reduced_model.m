%% Show_Results_Lib30_ALL_reduced_model
% SynTwin workflow script: visualization of Lib30 ALL reduced-model results.
%
% DESCRIPTION
%   Loads the compiled Results tensor generated by
%   Generate_Results_Lib30_ALL_reduced_model and produces representative plots:
%   - experimental vs predicted synthesis-rate trajectories (Pi)
%   - parameter estimates / distributions across estimation runs
%   - summary statistics and goodness-of-fit visualizations
%
% INPUTS
%   None (loads Results_Tensor_*.mat from the current folder).
%
% OUTPUTS
%   Figures shown on screen and/or saved to disk (depending on script settings).
%
% DEPENDENCIES
%   - SynTwin initialization recommended:
%       ROOT = init_SynTwin(...);
%   - Requires the corresponding Results_Tensor_*.mat to exist.
%
% USAGE
%   Show_Results_Lib30_ALL_reduced_model
%
% NOTES
%   - If you run from the SynTwin root, make sure this folder is on the path:
%       addpath(fileparts(mfilename('fullpath')));

% --- Portable project initialization (no absolute paths) ---
ROOT = init_SynTwin();  % Scripts_base + HEM_Surrogate are added by default
% Absolute path to the folder where this script lives (model folder)
SCRIPT_DIR = fileparts(mfilename('fullpath'));
addpath(SCRIPT_DIR);

% Getting the Results structure corresponding to the estimated parameters
% of Lib30 with the complete model using
% Generate_Results_Lib30_ALL_full_model.m and stored in this same folder
% CHANGE BETWEEN Global, Instances and Wells appropriately
load(fullfile(SCRIPT_DIR,'Results_Tensor_Lib30_ALL_reduced_model_Wells.mat'));

% Consider an exogenous circuit. We use a Transcriptional Unit (TU) expressing GFP:
model_c.lp_c = 240; %Length of GFP protein (aa)     
model_c.le_c = model_c.lp_c^0.097/0.0703; 	%Ribosome occupancy length (aa) %lea=la^0.097/0.0703
model_c.dm_c  =  0.2; %Mean degradation rate of non-ribosomal mRNA (1/min)
model_c.Em_c =  model_c.lp_c/model_c.le_c*(1- (model_c.lp_c/(model_c.lp_c+model_c.le_c))^(model_c.lp_c/model_c.le_c)) ;  
model_c.WEm_c =  1 + 1/model_c.Em_c;  
model_c.N_pSC101 = 5; %known

 indices_plasmids = [1,2];
 indices_promoters = [1,2,3];
 indices_rbss = [1,2,3,4,5];
 
% param bounds:
 Lower_Bounds = [0.025,0.05,0.05... %lower expected bounds for omega, promoter strengths,
          0.05, 2.5e-3, 0.05, 2.5e-3,2.5e-3 ...  %lower expected bounds for RBS_k0_sigma0, 
          2.5 ];  %lower expected bound for high copy number multiplying term 

 Upper_Bounds = [0.15,0.35,0.35... %upper expected bounds for omega, promoter strengths,
          2.0, 10e-3, 0.35, 8e-3,2e-2 ...  %upper expected bounds for RBS_k0_sigma0, 
          8.25 ];  %upper expected bound for high copy number multiplying term 


 title_text = 'Lib30. ALL. RM.';

 Plot_Results_Lib_reduced_model(Results_Tensor_Lib30_ALL_reduced,Lower_Bounds,Upper_Bounds,indices_plasmids,indices_promoters,indices_rbss, title_text)




